<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QR Code Scanner</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <h1>QR Code Scanner</h1>
    
    <video id="video" autoplay></video>

    <!-- Add an input field and button for URL input -->
    <div>
        <input type="text" id="urlInput" placeholder="Enter URL">
        <button onclick="scanQRCode()">Scan</button>
    </div>

    <!-- Add a result div to display the QR code result -->
    <div id="qrResult"></div>
    
    <script>
        // JavaScript for capturing video from the webcam and sending it to the server
        const video = document.getElementById('video');
        const qrResult = document.getElementById('qrResult'); // Get the result div
        
        navigator.mediaDevices
            .getUserMedia({ video: true })
            .then((stream) => {
                video.srcObject = stream;
            })
            .catch((error) => {
                console.error('Error accessing the webcam:', error);
            });
        
        // Function to send the URL for scanning and display the result
        async function scanQRCode() {
            const urlInput = document.getElementById('urlInput'); // Get the input field by id
            const url = urlInput.value; // Get the value of the input field
            
            if (url) {
                const response = await fetch('/scan', {
                    method: 'POST',
                    body: new URLSearchParams({ url }),
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                    },
                });
                
                const result = await response.json();
                
                if (result.status === 'success') {
                    qrResult.textContent = `Decoded QR Code: ${result.data.Decoded_QR_Code}`;
                } else {
                    qrResult.textContent = `Error: ${result.message}`;
                }
            }
        }
    </script>
</body>
</html>
